<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      font-family: Arial, sans-serif;
      font-size: 9px;
      line-height: 1.3;
      color: #000;
      padding: 20px 30px;
      width: 100%;
    }

    .header {
      margin-bottom: 16px;
      border-bottom: 2px solid #000;
      padding-bottom: 8px;
    }

    .header-content {
      display: flex;
      align-items: flex-start;
      gap: 20px;
    }

    .company-logo {
      width: 72px;
      height: 72px;
      border: 3px solid #2d5016;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #fff;
    }

    .company-logo img {
      width: 56px;
      height: 56px;
      border-radius: 50%;
    }

    .company-info {
      text-align: left;
      flex: 1;
    }

    .company-name {
      font-size: 22px;
      font-weight: 800;
      letter-spacing: 1.5px;
      margin-bottom: 4px;
    }

    .company-details {
      font-size: 9px;
      line-height: 1.4;
    }

    .quotation-info {
      display: flex;
      justify-content: space-between;
      margin-bottom: 16px;
      padding: 8px 10px;
      background-color: #e6e6e6;
      border-top: 4px solid #000;
      font-weight: bold;
    }

    .bill-ship-section {
      display: flex;
      justify-content: space-between;
      margin-bottom: 12px;
    }

    .bill-to, .ship-to {
      width: 48%;
    }

    .section-title {
      font-weight: bold;
      margin-bottom: 3px;
    }

    .contact-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
      width: 100%;
    }

    .contact-label {
      width: 400px;
      font-weight: bold;
    }

    .items-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 6px;
      font-size: 9px;
    }

    .items-table thead {
      border-bottom: 2px solid #000;
    }

    .items-table th {
      text-align: left;
      padding: 6px 4px;
      font-weight: bold;
      background-color: #fff;
    }

    .items-table td {
      padding: 6px 4px;
      border-bottom: 1px solid #ddd;
      vertical-align: top;
    }

    .items-table td:nth-child(2),
    .items-table td:nth-child(3),
    .items-table td:nth-child(4),
    .items-table td:nth-child(5) {
      text-align: center;
    }

    .item-description {
      text-align: left !important;
      font-size: 9px;
      line-height: 1.3;
    }

    .item-category {
      font-style: italic;
      color: #666;
      font-size: 8px;
      margin-top: 2px;
    }

    .below-table-wrapper {
      padding-top: 30px;
    }

    .subtotal-display {
      display: grid;
      grid-template-columns: 40% 12% 13% 15% 15%;
      font-weight: bold;
      padding: 6px 0;
      padding-left: 15px;
      border-top: 1px dashed #000;
      border-bottom: 1px dashed #000;
      margin-bottom: 24px;
      font-size: 9px;
    }

    .subtotal-display div:nth-child(1) {
      text-align: left;
    }

    .subtotal-display div:nth-child(2),
    .subtotal-display div:nth-child(3),
    .subtotal-display div:nth-child(4),
    .subtotal-display div:nth-child(5) {
      text-align: right;
    }

    .footer-section {
      display: flex;
      justify-content: space-between;
      margin-top: 12px;
    }

    .terms-section {
      width: 55%;
      font-size: 9px;
    }

    .terms-title {
      font-weight: bold;
      margin-bottom: 4px;
    }

    .totals-section {
      width: 40%;
      font-size: 9px;
    }

    .totals-table {
      width: 100%;
      text-align: right;
    }

    .totals-table td {
      padding: 2px 4px;
      border-bottom: 1px solid #ccc;
    }

    .total-amount td {
      border-top: 2px solid #000;
      font-weight: bold;
    }

    .amount-in-words {
      margin-top: 16px;
      text-align: right;
      font-size: 9px;
    }

    .amount-in-words-title {
      font-weight: bold;
      margin-bottom: 2px;
    }

    .currency {
      font-family: "Segoe UI", Arial, sans-serif;
    }

    .quote-label {
      position: absolute;
      bottom: 15px;
      right: 20px;
      font-weight: bold;
      font-size: 12px;
    }
  </style>
</head>
<body>
  <!-- Header Section -->
  <div class="header">
    <div class="header-content">
      <div class="company-logo">
        <img src="<%= typeof logoPath !== 'undefined' ? logoPath : 'https://crm.bhavyaentrprises.com/bhavyalogo.png' %>" alt="Logo" />
      </div>
      <div class="company-info">
        <div class="company-name">BHAVYA ENTERPRISES</div>
        <div class="company-details">
          Regd Office: SCO 393 2nd Floor, Sector 37-D, Chandigarh, 160022<br />
          B.O. : Plot No. 1025, Rani Sati Nagar, Nirman Nagar, Jaipur-302019<br />
          <b>Helpdesk No:</b> +91 9988818489, +91 9815922428 &nbsp; <br />
          <b>GSTIN:</b> 04AXJPV5221C1ZP &nbsp; <b>PAN Number:</b> AXJPV5221C<br />
          <b>Email:</b> bhavyaenterpriseschd@gmail.com
        </div>
      </div>
    </div>
  </div>

  <!-- Quotation Info -->
  <div class="quotation-info">
    <div>
      <b>Quotation No.:</b> <%= quoteNo || quotationId || 'PREVIEW' %>
    </div>
    <div>
      <b>Quotation Date:</b> <%= new Date().toLocaleDateString('en-GB') %>
    </div>
    <div><b>Expiry Date:</b> <%= validUntil %></div>
  </div>

  <!-- Bill To / Ship To Section -->
  <div class="bill-ship-section">
    <div class="bill-to">
      <div class="section-title">BILL TO <%= clientName %></div>
      <% if (typeof client !== 'undefined' && client) { %>
      <div class="contact-grid">
        <div>
          <span class="contact-label">Name:</span>
          <span><%= client.contactPerson || '-' %></span>
        </div>
        <div>
          <span class="contact-label">Email:</span>
          <span><%= client.contactEmail || '-' %></span>
        </div>
        <div>
          <span class="contact-label">GSTIN:</span>
          <span><%= client.gstn || '-' %></span>
        </div>
        <div>
          <span class="contact-label">Phone:</span>
          <span><%= client.contactPhone || '-' %></span>
        </div>
      </div>
      <% } %>
    </div>
  </div>

  <!-- Items Table -->
  <table class="items-table">
    <thead>
      <tr>
        <th style="width: 40%">ITEMS</th>
        <th style="width: 12%; text-align: center">QTY.</th>
        <th style="width: 12%; text-align: center">RATE</th>
        <th style="width: 12%; text-align: center">TAX</th>
        <th style="width: 14%; text-align: center">AMOUNT</th>
      </tr>
    </thead>
    <tbody>
      <% let totalQty = 0; let totalTaxAmount = 0; %>
      <% rateCards.forEach((card, index) => { const detail = rateCardDetails.find(d => d.rateCardId === card.id); if (!detail) return; const itemSubtotal = card.rate * detail.quantity; const gstAmount = itemSubtotal * (detail.gstPercentage / 100); const totalItemAmount = itemSubtotal + gstAmount; totalQty += detail.quantity; totalTaxAmount += gstAmount; %>
      <tr>
        <td class="item-description">
          <div><b>( C) <%= card.description %></b></div>
        </td>
        <td><%= detail.quantity %> NOS</td>
        <td><%= card.rate.toFixed(2) %></td>
        <td>
          <%= gstAmount.toFixed(2) %>
          <span style="font-size: 8px">(<%= detail.gstPercentage %>%)</span>
        </td>
        <td><%= totalItemAmount.toFixed(2) %></td>
      </tr>
      <% }) %>
    </tbody>
  </table>

  <!-- Subtotal + Footer -->
  <div class="below-table-wrapper">
    <div class="subtotal-display">
      <div><b>SUBTOTAL</b></div>
      <div><%= totalQty %> items</div>
      <div></div>
      <div>
        <span class="currency">₹</span> <%= totalTaxAmount.toFixed(2) %> tax
      </div>
      <div><span class="currency">₹</span> <%= grandTotal.toFixed(2) %></div>
    </div>

    <div class="footer-section">
      <div class="terms-section">
        <div class="terms-title">TERMS AND CONDITIONS</div>
        <div>
          1. Goods once sold will not be taken back or exchanged<br />
          2. All disputes are subject to [ENTER_YOUR_CITY_NAME] jurisdiction only
        </div>
      </div>
      <div class="totals-section">
        <table class="totals-table">
          <tr>
            <td style="border: none">TAXABLE AMOUNT</td>
            <td style="border: none">
              <span class="currency">₹</span> <%= subtotal.toFixed(2) %>
            </td>
          </tr>
          <tr>
            <td style="border: none">CGST @18%</td>
            <td style="border: none">
              <span class="currency">₹</span> <%= (gst/2).toFixed(2) %>
            </td>
          </tr>
          <tr>
            <td style="border: none">SGST @18%</td>
            <td style="border: none">
              <span class="currency">₹</span> <%= (gst/2).toFixed(2) %>
            </td>
          </tr>
          <tr class="total-amount">
            <td>TOTAL AMOUNT</td>
            <td>
              <span class="currency">₹</span> <%= grandTotal.toFixed(2) %>
            </td>
          </tr>
        </table>
      </div>
    </div>

    <div class="amount-in-words">
      <div class="amount-in-words-title">Total Amount (in words)</div>
      <div><%= amountInWords %></div>
    </div>
  </div>

  <!-- Final Notes Section -->
  <div style="margin-top: 30px; font-size: 9px">
    <div style="font-style: italic">
      This is a computer-generated document. No signature or stamp is required.
    </div>
    <div style="margin-top: 8px">
      <b>Note:</b> A 50% advance payment is required to initiate the work. The remaining 50% will be payable upon completion or as per agreed milestones. This ensures smooth project execution and timely resource allocation.
    </div>
  </div>
</body>
</html>
