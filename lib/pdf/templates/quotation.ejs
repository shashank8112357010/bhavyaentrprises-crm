<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      font-size: 11px;
      line-height: 1.3;
      color: #000;
      padding: 15px;
    }

    .header {
      text-align: center;
      margin-bottom: 15px;
    }

    .company-logo {
      width: 50px;
      height: 50px;
      border: 3px solid #2d5016;
      border-radius: 50%;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 8px;
      background-color: #fff;
    }

    .logo-text {
      font-size: 20px;
      font-weight: bold;
      color: #2d5016;
    }

    .company-name {
      font-size: 16px;
      font-weight: bold;
      margin-bottom: 3px;
      letter-spacing: 1px;
    }

    .company-details {
      font-size: 9px;
      line-height: 1.1;
      margin-bottom: 10px;
    }

    .quotation-info {
      display: flex;
      justify-content: space-between;
      margin-bottom: 15px;
      font-size: 10px;
      background-color: #f5f5f5;
      padding: 5px 10px;
      border: 1px solid #000;
    }

    .bill-ship-section {
      display: flex;
      justify-content: space-between;
      margin-bottom: 15px;
      font-size: 10px;
    }

    .bill-to, .ship-to {
      width: 48%;
      padding: 5px 0;
    }

    .section-title {
      font-weight: bold;
      margin-bottom: 3px;
    }

    .items-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 15px;
      font-size: 9px;
    }

    .items-table th {
      background-color: #000;
      color: #fff;
      border: 1px solid #000;
      padding: 6px 4px;
      text-align: center;
      font-weight: bold;
      font-size: 9px;
    }

    .items-table td {
      border: 1px solid #000;
      padding: 4px;
      text-align: center;
      vertical-align: top;
    }

    .item-description {
      text-align: left !important;
      font-size: 8px;
      line-height: 1.2;
    }

    .item-category {
      font-style: italic;
      color: #666;
      font-size: 7px;
      margin-top: 2px;
    }

    .subtotal-row {
      background-color: #000;
      color: #fff;
      font-weight: bold;
    }

    .subtotal-row td {
      border: 1px solid #000;
      padding: 6px 4px;
    }

    .footer-section {
      display: flex;
      justify-content: space-between;
      margin-top: 15px;
    }

    .terms-section {
      width: 60%;
      font-size: 9px;
    }

    .terms-title {
      font-weight: bold;
      margin-bottom: 5px;
    }

    .terms-list {
      line-height: 1.3;
    }

    .totals-section {
      width: 35%;
      font-size: 9px;
    }

    .totals-table {
      width: 100%;
      text-align: right;
    }

    .totals-table td {
      padding: 2px 5px;
      border-bottom: 1px solid #ccc;
    }

    .total-amount {
      font-weight: bold;
      font-size: 10px;
      border-top: 2px solid #000;
      padding-top: 3px;
    }

    .amount-in-words {
      margin-top: 20px;
      text-align: right;
      font-size: 9px;
    }

    .amount-in-words-title {
      font-weight: bold;
      margin-bottom: 2px;
    }

    .quotation-watermark {
      margin-top: 40px;
      text-align: center;
      font-size: 24px;
      font-weight: bold;
      color: #ddd;
      letter-spacing: 3px;
    }

    .currency {
      font-family: "Segoe UI", Arial, sans-serif;
    }
  </style>
</head>
<body>
  <!-- Header Section -->
  <div class="header">
    <div class="company-logo">
      <div class="logo-text">BE</div>
    </div>
    <div class="company-name">BHAVYA ENTERPRISES</div>
    <div class="company-details">
      208/1,Near Gurudwara, Main Market,, Badheri,Sector 41-D,Chandigarh Tel. : 0172-4090428,<br>
      Chandigarh, Chandigarh, 160022<br>
      <strong>Mobile:</strong> 8699511189 &nbsp;&nbsp;&nbsp; <strong>GSTIN:</strong> 04AXJPV5221C1ZP &nbsp;&nbsp;&nbsp; <strong>PAN Number:</strong> AXJPV5221C<br>
      <strong>Email:</strong> bhavyaenterpriseschd@gmail.com
    </div>
  </div>

  <!-- Quotation Info -->
  <div class="quotation-info">
    <div>
      <strong>Quotation No.:</strong> <%= (typeof quoteNo !== 'undefined' && quoteNo) ? quoteNo : ((typeof quotationId !== 'undefined' && quotationId) ? quotationId : 'PREVIEW') %>
    </div>
    <div>
      <strong>Quotation Date:</strong> <%= new Date().toLocaleDateString('en-GB') %>
    </div>
    <div>
      <strong>Expiry Date:</strong> <%= validUntil ? new Date(validUntil).toLocaleDateString('en-GB') : new Date(Date.now() + 7*24*60*60*1000).toLocaleDateString('en-GB') %>
    </div>
  </div>

  <!-- Bill To / Ship To Section -->
  <div class="bill-ship-section">
    <div class="bill-to">
      <div class="section-title">BILL TO</div>
      <div><%= clientName %></div>
    </div>
    <div class="ship-to">
      <div class="section-title">SHIP TO</div>
      <div><%= clientName %></div>
    </div>
  </div>

  <!-- Items Table -->
  <table class="items-table">
    <thead>
      <tr>
        <th style="width: 45%;">ITEMS</th>
        <th style="width: 15%;">QTY.</th>
        <th style="width: 15%;">RATE</th>
        <th style="width: 15%;">TAX</th>
        <th style="width: 15%;">AMOUNT</th>
      </tr>
    </thead>
    <tbody>
      <% let totalQty = 0; %>
      <% let totalTaxAmount = 0; %>
      <% rateCards.forEach((card, index) => {
        const detail = rateCardDetails.find(d => d.rateCardId === card.id);
        if (!detail) return;
        const itemSubtotal = card.rate * detail.quantity;
        const gstAmount = itemSubtotal * (detail.gstPercentage / 100);
        const totalItemAmount = itemSubtotal + gstAmount;
        totalQty += detail.quantity;
        totalTaxAmount += gstAmount;
      %>
      <tr>
        <td class="item-description">
          <div><strong>( C) <%= card.description %></strong></div>
          <div class="item-category">Sanitary & Plumbing</div>
        </td>
        <td><%= detail.quantity %> NOS</td>
        <td><%= card.rate %></td>
        <td>
          <%= gstAmount.toFixed(1) %><br>
          <small>(<%= detail.gstPercentage %>%)</small>
        </td>
        <td><%= totalItemAmount.toFixed(1) %></td>
      </tr>
      <% }) %>

      <!-- Subtotal Row -->
      <tr class="subtotal-row">
        <td><strong>SUBTOTAL</strong></td>
        <td><strong><%= totalQty %></strong></td>
        <td><strong><span class="currency">₹</span> <%= totalTaxAmount.toFixed(2) %></strong></td>
        <td><strong><span class="currency">₹</span> <%= grandTotal.toFixed(2) %></strong></td>
        <td></td>
      </tr>
    </tbody>
  </table>

  <!-- Footer Section with Terms and Totals -->
  <div class="footer-section">
    <div class="terms-section">
      <div class="terms-title">TERMS AND CONDITIONS</div>
      <div class="terms-list">
        1. Goods once sold will not be taken back or exchanged<br>
        2. All disputes are subject to Chandigarh jurisdiction only
      </div>
    </div>

    <div class="totals-section">
      <table class="totals-table">
        <tr>
          <td><strong>TAXABLE AMOUNT</strong></td>
          <td><strong><span class="currency">₹</span> <%= subtotal.toLocaleString() %></strong></td>
        </tr>
        <tr>
          <td><strong>CGST @9%</strong></td>
          <td><strong><span class="currency">₹</span> <%= (gst/2).toFixed(2) %></strong></td>
        </tr>
        <tr>
          <td><strong>SGST @9%</strong></td>
          <td><strong><span class="currency">₹</span> <%= (gst/2).toFixed(2) %></strong></td>
        </tr>
        <tr class="total-amount">
          <td><strong>TOTAL AMOUNT</strong></td>
          <td><strong><span class="currency">₹</span> <%= grandTotal.toFixed(2) %></strong></td>
        </tr>
      </table>
    </div>
  </div>

  <!-- Amount in Words -->
  <div class="amount-in-words">
    <div class="amount-in-words-title"><strong>Total Amount (in words)</strong></div>
    <div><%= amountInWords %></div>
  </div>

  <!-- Quotation Watermark -->
  <div class="quotation-watermark">
    QUOTATION
  </div>
</body>
</html>
